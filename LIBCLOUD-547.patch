From c2451f4e37f6823fec55fde00f88f1376eb3d999 Mon Sep 17 00:00:00 2001
From: Gary Wilson <@earthgecko>
Date: Thu, 31 May 2012 18:50:36 +0100
Subject: [PATCH 1/3] IssueID #201 LIBCLOUD-201 zone.id changed to zone in
 lines 433 and 434 Modified:
 libcloud/dns/drivers/zerigo.py

---
 libcloud/dns/drivers/zerigo.py |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/libcloud/dns/drivers/zerigo.py b/libcloud/dns/drivers/zerigo.py
index e327512..7fce9be 100644
--- a/libcloud/dns/drivers/zerigo.py
+++ b/libcloud/dns/drivers/zerigo.py
@@ -430,8 +430,8 @@ class ZerigoDNSDriver(DNSDriver):
             transform_func = self._to_zones
         elif value_dict['type'] == 'records':
             zone = value_dict['zone']
-            path = API_ROOT + 'zones/%s/hosts.xml' % (zone.id)
-            self.connection.set_context({'resource': 'zone', 'id': zone.id})
+            path = API_ROOT + 'zones/%s/hosts.xml' % (zone)
+            self.connection.set_context({'resource': 'zone', 'id': zone})
             response = self.connection.request(path, params=params)
             transform_func = self._to_records
             transform_func_kwargs['zone'] = value_dict['zone']
-- 
1.7.9.5


From 6b45f6a5c188a1172c21da19e34cec026e447863 Mon Sep 17 00:00:00 2001
From: Gary Wilson <@earthgecko>
Date: Thu, 31 May 2012 18:59:52 +0100
Subject: [PATCH 2/3] IssueID #201 LIBCLOUD-201 Restored original:
 libcloud/dns/drivers/zerigo.py

---
 libcloud/dns/drivers/zerigo.py |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/libcloud/dns/drivers/zerigo.py b/libcloud/dns/drivers/zerigo.py
index 7fce9be..e327512 100644
--- a/libcloud/dns/drivers/zerigo.py
+++ b/libcloud/dns/drivers/zerigo.py
@@ -430,8 +430,8 @@ class ZerigoDNSDriver(DNSDriver):
             transform_func = self._to_zones
         elif value_dict['type'] == 'records':
             zone = value_dict['zone']
-            path = API_ROOT + 'zones/%s/hosts.xml' % (zone)
-            self.connection.set_context({'resource': 'zone', 'id': zone})
+            path = API_ROOT + 'zones/%s/hosts.xml' % (zone.id)
+            self.connection.set_context({'resource': 'zone', 'id': zone.id})
             response = self.connection.request(path, params=params)
             transform_func = self._to_records
             transform_func_kwargs['zone'] = value_dict['zone']
-- 
1.7.9.5


From 990ffe9fba172aaef2af23ba2ebe7dae60b3b084 Mon Sep 17 00:00:00 2001
From: earthgecko <gary.wilson@of-networks.co.uk>
Date: Tue, 29 Apr 2014 15:28:57 +0100
Subject: [PATCH 3/3] IssueID #547: linode.py labels too long with name use
 linode id instead

---
 libcloud/compute/drivers/linode.py |   22 ++++++++++++----------
 1 file changed, 12 insertions(+), 10 deletions(-)

diff --git a/libcloud/compute/drivers/linode.py b/libcloud/compute/drivers/linode.py
index c58f56a..d20db66 100644
--- a/libcloud/compute/drivers/linode.py
+++ b/libcloud/compute/drivers/linode.py
@@ -284,16 +284,6 @@ class LinodeNodeDriver(NodeDriver):
         comments = "Created by Apache libcloud <http://www.libcloud.org>" if\
             "ex_comment" not in kwargs else kwargs["ex_comment"]
 
-        # Labels
-        label = {
-            "lconfig": "[%s] Configuration Profile" % name,
-            "lroot": "[%s] %s Disk Image" % (name, image.name),
-            "lswap": "[%s] Swap Space" % name
-        }
-        for what in ["lconfig", "lroot", "lswap"]:
-            if what in kwargs:
-                label[what] = kwargs[what]
-
         # Step 1: linode.create
         params = {
             "api_action": "linode.create",
@@ -320,6 +310,18 @@ class LinodeNodeDriver(NodeDriver):
             }
             self.connection.request(API_ROOT, params=params)
 
+        # Step 1d. Labels
+        # use the linode id as the name can be up to 63 chars and the labels are
+        # limited to 48 chars
+        label = {
+            "lconfig": "[%s] Configuration Profile" % linode["id"],
+            "lroot": "[%s] %s Disk Image" % (linode["id"], image.name),
+            "lswap": "[%s] Swap Space" % linode["id"]
+        }
+        for what in ["lconfig", "lroot", "lswap"]:
+            if what in kwargs:
+                label[what] = kwargs[what]
+
         # Step 2: linode.disk.createfromdistribution
         if not root:
             root = binascii.b2a_base64(os.urandom(8)).decode('ascii').strip()
-- 
1.7.9.5

